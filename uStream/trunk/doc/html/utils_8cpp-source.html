<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>uStream: C:/ustream_streaming_architecture/uOsUtil/src/core/utils.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">ustream_streaming_architecture</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">uOsUtil</a>&nbsp;/&nbsp;<a class="el" href="dir_000006.html">src</a>&nbsp;/&nbsp;<a class="el" href="dir_000007.html">core</a></div>
<h1>utils.cpp</h1><a href="utils_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment">  uSTREAM LIGHT-WEIGHT STREAMING ARCHITECTURE</span>
00003 <span class="comment">  Copyright (C) 2005 Luis Serrano (luis@kontrol-dj.com) </span>
00004 <span class="comment">  </span>
00005 <span class="comment">  Based on DANUBIO STREAMING ARCHITECTURE by Michele Iacobellis (m.iacobellis@nexotech.it)</span>
00006 <span class="comment">  </span>
00007 <span class="comment">  This program is free software; you can redistribute it and/or modify</span>
00008 <span class="comment">  it under the terms of the GNU General Public License as published by</span>
00009 <span class="comment">  the Free Software Foundation; either version 2 of the License, or</span>
00010 <span class="comment">  (at your option) any later version.</span>
00011 <span class="comment">  </span>
00012 <span class="comment">  This program is distributed in the hope that it will be useful,</span>
00013 <span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00014 <span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00015 <span class="comment">  GNU General Public License for more details.</span>
00016 <span class="comment">  </span>
00017 <span class="comment">  You should have received a copy of the GNU General Public License</span>
00018 <span class="comment">  along with this program; if not, write to the Free Software</span>
00019 <span class="comment">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00020 <span class="comment">*/</span>
00021 
00022 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00023 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00024 <span class="preprocessor">#include &lt;string.h&gt;</span>
00025 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>
00026 <span class="preprocessor">#include &lt;time.h&gt;</span>
00027 
00028 <span class="preprocessor">#include "<a class="code" href="typedefs_8hpp.html">typedefs.hpp</a>"</span>
00029 <span class="preprocessor">#include "<a class="code" href="utils_8hpp.html">utils.hpp</a>"</span>
00030 <span class="preprocessor">#include "<a class="code" href="vector_8hpp.html">vector.hpp</a>"</span>
00031 
00032 <span class="keyword">namespace </span>uStreamLib {
00033         <span class="comment">/*</span>
00034 <span class="comment">         * Methods.</span>
00035 <span class="comment">         */</span>
<a name="l00036"></a><a class="code" href="classu_stream_lib_1_1_utils.html#e0">00036</a>         <a class="code" href="namespaceu_stream_lib.html#a244">int32</a> Utils::getDelim(<span class="keywordtype">char</span>* line, uint32 size, <span class="keywordtype">char</span> delim, FILE* fp)
00037         {
00038                 <span class="keyword">register</span> <a class="code" href="namespaceu_stream_lib.html#a243">uint32</a> count = 0;
00039                 <span class="keywordtype">char</span> c, next = 0;
00040 
00041                 <span class="keywordflow">do</span> {
00042                         c = (char) fgetc(fp);
00043                         <span class="keywordflow">if</span> (c == EOF)
00044                                 <span class="keywordflow">break</span>;
00045 
00046                         <span class="keywordflow">if</span> (c == <span class="charliteral">'\\'</span>) {
00047                                 next = (char) fgetc(fp);
00048                                 <span class="keywordflow">if</span> (next == delim) {
00049                                         <span class="keywordflow">continue</span>;
00050                                 } <span class="keywordflow">else</span> {
00051                                         ungetc(next, fp);
00052                                 }
00053                         }
00054 
00055                         line[count++] = c;
00056 
00057                         <span class="keywordflow">if</span> (count &gt; size) {
00058                                 line[count - 2] = delim;
00059                                 line[count - 1] = 0;
00060                                 <span class="keywordflow">return</span> size;
00061                         }
00062 
00063                         <span class="keywordflow">if</span> (c == delim) {
00064                                 line[count] = 0;
00065                                 <span class="keywordflow">return</span> count;
00066                         }
00067                 } <span class="keywordflow">while</span> (1);
00068 
00069                 <span class="keywordflow">return</span> FAILURE;
00070         }
00071 
<a name="l00072"></a><a class="code" href="classu_stream_lib_1_1_utils.html#e1">00072</a>         <span class="keywordtype">char</span>* Utils::getToken(<span class="keywordtype">char</span>** cur, <span class="keywordtype">char</span>* delim, uint32 cursz,
00073                 uint32 delimsz)
00074         {
00075                 <span class="keyword">register</span> <span class="keywordtype">char</span> * dlm = delim;
00076                 <span class="keyword">register</span> <span class="keywordtype">char</span> * start = *cur, * str = *cur;
00077 
00078                 <span class="keywordflow">if</span> (!cur || !delim)
00079                         <span class="keywordflow">return</span> NULL;
00080                 <span class="keywordflow">if</span> (!*cur)
00081                         <span class="keywordflow">return</span> NULL;
00082 
00083                 <span class="keywordflow">do</span> {
00084                         dlm = delim;
00085 
00086                         <span class="keywordflow">do</span> {
00087                                 <span class="keywordflow">if</span> (*str == *dlm) {
00088                                         *str = 0;
00089                                         *cur = ++str;
00090 
00091                                         <span class="keywordflow">return</span> start;
00092                                 }
00093                         } <span class="keywordflow">while</span> (*(++dlm));
00094                 } <span class="keywordflow">while</span> (*(str++));
00095 
00096                 *cur = NULL;
00097                 <span class="keywordflow">return</span> start;
00098         }
00099 
<a name="l00100"></a><a class="code" href="classu_stream_lib_1_1_utils.html#e2">00100</a>         <span class="keywordtype">char</span>* Utils::int32ToString(int32 value, <span class="keywordtype">char</span>* out, uint32 out_sz)
00101         {
00102                 snprintf(out, out_sz, <span class="stringliteral">"%d"</span>, value);
00103                 <span class="keywordflow">return</span> out;
00104         }
00105 
<a name="l00106"></a><a class="code" href="classu_stream_lib_1_1_utils.html#e3">00106</a>         <span class="keywordtype">char</span>* Utils::uint32ToString(uint32 value, <span class="keywordtype">char</span>* out, uint32 out_sz)
00107         {
00108                 snprintf(out, out_sz, <span class="stringliteral">"%d"</span>, value);
00109                 <span class="keywordflow">return</span> out;
00110         }
00111 
<a name="l00112"></a><a class="code" href="classu_stream_lib_1_1_utils.html#e4">00112</a>         <span class="keywordtype">char</span>* Utils::int64ToString(int64 value, <span class="keywordtype">char</span>* out, uint32 out_sz)
00113         {
00114 <span class="preprocessor">#if defined(WIN32) || defined(_WIN32)</span>
00115 <span class="preprocessor"></span>                <span class="keywordflow">return</span> _i64toa(value, out, 10);
00116 <span class="preprocessor">#else</span>
00117 <span class="preprocessor"></span>                snprintf(out, out_sz, <span class="stringliteral">"%lld"</span>, value);
00118                 <span class="keywordflow">return</span> out;
00119 <span class="preprocessor">#endif</span>
00120 <span class="preprocessor"></span>        }
00121 
<a name="l00122"></a><a class="code" href="classu_stream_lib_1_1_utils.html#e5">00122</a>         <span class="keywordtype">char</span>* Utils::uint64ToString(uint64 value, <span class="keywordtype">char</span>* out, uint32 out_sz)
00123         {
00124 <span class="preprocessor">#if defined(WIN32) || defined(_WIN32)</span>
00125 <span class="preprocessor"></span>                <span class="keywordflow">return</span> _ui64toa(value, out, 10);
00126 <span class="preprocessor">#else</span>
00127 <span class="preprocessor"></span>                snprintf(out, out_sz, <span class="stringliteral">"%llu"</span>, value);
00128                 <span class="keywordflow">return</span> out;
00129 <span class="preprocessor">#endif</span>
00130 <span class="preprocessor"></span>        }
00131 
<a name="l00132"></a><a class="code" href="classu_stream_lib_1_1_utils.html#e6">00132</a>         <a class="code" href="namespaceu_stream_lib.html#a244">int32</a> Utils::stringToInt32(<span class="keywordtype">char</span>* in)
00133         {
00134                 return ::strtol(in, NULL, 10);
00135         }
00136 
<a name="l00137"></a><a class="code" href="classu_stream_lib_1_1_utils.html#e8">00137</a>         <a class="code" href="namespaceu_stream_lib.html#a242">int64</a> Utils::stringToInt64(<span class="keywordtype">char</span>* in)
00138         {
00139 <span class="preprocessor">#if defined(WIN32) || defined(_WIN32)</span>
00140 <span class="preprocessor"></span>                <span class="keywordflow">return</span> _atoi64(in);
00141 <span class="preprocessor">#else</span>
00142 <span class="preprocessor"></span>                <span class="keywordflow">return</span> strtoll(in, NULL, 10);
00143 <span class="preprocessor">#endif</span>
00144 <span class="preprocessor"></span>        }
00145 
<a name="l00146"></a><a class="code" href="classu_stream_lib_1_1_utils.html#e7">00146</a>         <a class="code" href="namespaceu_stream_lib.html#a243">uint32</a> Utils::stringToUint32(<span class="keywordtype">char</span>* in)
00147         {
00148                 return ::strtoul(in, NULL, 10);
00149         }
00150 
<a name="l00151"></a><a class="code" href="classu_stream_lib_1_1_utils.html#e9">00151</a>         <a class="code" href="namespaceu_stream_lib.html#a241">uint64</a> Utils::stringToUint64(<span class="keywordtype">char</span>* in)
00152         {
00153 <span class="preprocessor">#if defined(WIN32) || defined(_WIN32)</span>
00154 <span class="preprocessor"></span>                <span class="keywordflow">return</span> (uint64) _atoi64(in);
00155 <span class="preprocessor">#else</span>
00156 <span class="preprocessor"></span>                <span class="keywordflow">return</span> strtoull(in, NULL, 0);
00157 <span class="preprocessor">#endif</span>
00158 <span class="preprocessor"></span>        }
00159 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Feb 9 19:03:32 2006 for uStream by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
